 <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FabricPop — REEL Reviews, REAL People</title>
    <style>
      body {
        font-family: system-ui, sans-serif;
        background: #f9fafb;
        color: #111827;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100vh;
        margin: 0;
      }
      h1 {
        font-size: 2rem;
        margin-bottom: 1rem;
      }
      button {
        background-color: #4f46e5;
        color: white;
        padding: 0.75rem 1.5rem;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 1rem;
      }
      button:hover {
        background-color: #4338ca;
      }
      .msg {
        margin-top: 1rem;
        font-size: 0.9rem;
        word-break: break-all;
      }
    </style>
  </head>

  <body>
    <h1>FabricPop — Connect Polkadot Wallet</h1>

    <button id="connectBtn">Connect Wallet</button>

    <div id="message" class="msg"></div>

    <script type="module">
      import {
        web3Enable,
        web3Accounts,
        web3FromAddress,
      } from "https://esm.sh/@polkadot/extension-dapp";

      const connectBtn = document.getElementById("connectBtn");
      const msg = document.getElementById("message");

      connectBtn.addEventListener("click", async () => {
        msg.textContent = "Connecting...";

        try {
          // Ask for permission to use wallet extensions
          const extensions = await web3Enable("FabricPop");
          if (extensions.length === 0) {
            msg.innerHTML =
              "❌ No Polkadot wallet extension found.<br>Please install <a href='https://talisman.xyz' target='_blank'>Talisman</a> or <a href='https://polkadot.js.org/extension/' target='_blank'>Polkadot.js</a>.";
            return;
          }

          // Get accounts
          const accounts = await web3Accounts();
          if (accounts.length === 0) {
            msg.textContent = "No accounts found in wallet.";
            return;
          }

          const account = accounts[0];
          msg.textContent = `✅ Connected: ${account.address}`;

          // Optional: get signer for transactions
          const injector = await web3FromAddress(account.address);
          console.log("Connected account:", account);
          console.log("Signer injector:", injector);
        } catch (err) {
          console.error("Connection error:", err);
          msg.textContent = "⚠️ Failed to connect wallet. Check console for details.";
        }
      });
    </script>
  </body>
</html>
